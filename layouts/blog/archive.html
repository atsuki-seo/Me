{{ define "main" }}
<div class="blog-layout blog-layout-3col">
    {{ partial "blog-sidebar-left.html" . }}
    <div class="blog-main">
        <div class="blog-header">
            <h1><i class="fas fa-calendar-alt"></i> {{ .Params.year }}年{{ .Params.month }}月</h1>
            {{ $year := .Params.year }}
            {{ $month := .Params.month }}
            {{ $allPosts := where site.RegularPages "Section" "blog" }}
            {{ $filtered := slice }}
            {{ range $allPosts }}
                {{ $postYear := .Date.Format "2006" | int }}
                {{ $postMonth := .Date.Format "1" | int }}
                {{ if and (eq $postYear $year) (eq $postMonth $month) }}
                    {{ $filtered = $filtered | append . }}
                {{ end }}
            {{ end }}
            <p>{{ .Params.year }}年{{ .Params.month }}月の記事一覧：{{ len $filtered }}件</p>
        </div>

        <a href="/blog/" class="back-link back-link-top" style="margin-top: 0;">
            <i class="fas fa-arrow-left"></i> ホームに戻る
        </a>

        {{ $paginator := .Paginate $filtered 5 }}

        {{ range $paginator.Pages }}
        <article class="post-card">
            <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
            <div class="post-meta">
                <span class="post-meta-item">
                    <i class="fas fa-calendar-alt"></i> {{ .Date.Format "2006年1月2日" }}
                </span>
                {{ with .GetTerms "tags" }}
                <span class="post-meta-item">
                    <i class="fas fa-tags"></i>
                    {{ range . }}
                    <a href="{{ .RelPermalink }}" class="tag">{{ .LinkTitle }}</a>
                    {{ end }}
                </span>
                {{ end }}
            </div>
            <p class="post-excerpt">{{ .Description }}</p>
            <a href="{{ .Permalink }}" class="read-more">
                続きを読む <i class="fas fa-arrow-right"></i>
            </a>
        </article>
        {{ end }}

        {{ partial "pagination.html" (dict "paginator" $paginator) }}

        <a href="/blog/" class="back-link" style="display: inline-block; margin-top: 30px;">
            <i class="fas fa-arrow-left"></i> ホームに戻る
        </a>
    </div>

    {{ partial "blog-sidebar.html" . }}
    {{ partial "footer.html" . }}
</div>
{{ end }}
